library(lubridate); library(stringr); library(purrr); library(readr)
library(readr)
finStatement <- read_csv("http://mopsfin.twse.com.tw/opendata/t187ap06_O_ci.csv")
library(lubridate); library(stringr); library(purrr); library(readr)
library(readr)
finStatement <- read_csv("http://mopsfin.twse.com.tw/opendata/t187ap06_O_ci.csv")
View(finStatement)
# loss1Companies
finStatement$`營業利益（損失）`
# loss1Companies
finStatement$`營業利益（損失）`< 0 ->lossC
lossC
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies
loss1Companies as.character(loss1Companies)
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies
loss1Companies ->  as.character(loss1Companies)
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies1
loss1Companies1[loss1Companies1]
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies1
loss1Companies1[loss1Companies1] -> loss1Companies2
loss1Companies <- loss1Companies1 & !loss1Companies2
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies1
loss1Companies1[loss1Companies1] -> loss1Companies2
loss1Companies <- loss1Companies1 & !loss1Companies2
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss2Companies
finStatement$`基本每股盈餘（元）` < 0 -> loss2Companies
loss2Companies <- as.character(loss2Companies)
loss2Companies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a & b -> only1LossCompanies
only1LossCompanies <- as.character(only1LossCompanies)
only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> only1LossCompanies
only1LossCompanies <- as.character(only1LossCompanies)
only1LossCompanies
library(httr)
exhibitionList <- content(GET("https://cloud.culture.tw/frontsite/trans/SearchShowAction.do?method=doFindTypeJ&category=6"))
str(exhibitionList[[1]])
# numExhibitions
length(exhibitionList)
# numExhibitions
length(exhibitionList) -> numExhibitions
numEX
str(exhibitionList[[1]])
# subsample
finStatement[3,]
# subsample
finStatement[a | b, ]
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> only1LossCompanies
only1LossCompanies <- as.character(only1LossCompanies)
only1LossCompanies
# loss1Companies
finStatement$`營業利益（損失）`< 0 -> loss1Companies
loss1Companies <-  as.character(loss1Companies)
loss1Companies
# loss2Companies
finStatement$`基本每股盈餘（元）` < 0 -> loss2Companies
loss2Companies <- as.character(loss2Companies)
loss2Companies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
finStatement[a]
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
finStatement[a,]
a | b -> only1LossCompanies
only1LossCompanies <- as.character(only1LossCompanies)
only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
finStatement[a, ] -> c
finStatement[b, ] -> d
c | d -> only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c, ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c, ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
class(c)
finStatement[c, ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c,"公司名稱" ] <- only1LossCompanies
library(readr)
finStatement <- read_csv("http://mopsfin.twse.com.tw/opendata/t187ap06_O_ci.csv")
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c,"公司名稱" ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c, 5 ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
c
finStatement[c, 5 ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
length(c)
length(finStatement)
finStatement[c, 5 ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
length(c)
length(finStatement)
finStatement[5, c ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement[c, 5 ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
sum(c)-sum(b)-sum(a)
finStatement[c, 5 ] <- only1LossCompanies
# only1LossCompanies
finStatement$`營業利益（損失）`> 0 & finStatement$`基本每股盈餘（元）` < 0 -> a
finStatement$`營業利益（損失）`< 0 & finStatement$`基本每股盈餘（元）` > 0 -> b
a | b -> c
finStatement$公司名稱 -> company
company[c] -> only1LossCompanies
only1LossCompanies <- as.character(only1LossCompanies)
only1LossCompanies
# subsample
finStatement[a | b, ]
# subsample
finStatement[a | b, ] -> subsample
subsample
# numExhibitions
length(exhibitionList) -> numExhibitions
numExhibitions
knitr::opts_chunk$set(echo = TRUE)
Vector1 <- letters[1:6]
Vector1
names(Vector1)
names(Vector1) <- c('名稱1','名稱2','名稱3','名稱4','名稱5','名稱6')
names(Vector1)
StuDF2 <- data.frame(
學號=c(172,214,322,425,517),
姓名=c("小明","大雄","胖虎","小新","大白"),
成績=c(80,60,90,70,50),
stringsAsFactors = FALSE
)
StuDF2
colnames(StuDF2) <- c("col1","col2","col3")
StuDF2
colnames(StuDF2)[c(2,3)] <- c("name","grade")
StuDF2
# numExhibitions
length(exhibitionList) -> numExhibitions
numExhibitions
# df_oneShow
df_oneShow <- data.frame(
exhibitionList[[1]]$title
)
# df_oneShow
df_oneShow <- data.frame(
exhibitionList[[1]]$title
)
# df_oneShow
df_oneShow <- data.frame(
exhibitionList[[1]]$title
)
df_oneShow
# df_oneShow
df_oneShow <- data.frame(
title=exhibitionList[[1]]$title,
time=exhibitionList[[1]]$showInfo
)
df_oneShow
exhibitionList[[1]]$showInfo
# df_oneShow
df_oneShow <- data.frame(
title=exhibitionList[[1]]$title,
time=exhibitionList[[1]]$showInfo
)
exhibitionList[[1]]$showInfo
View(exhibitionList)
# df_oneShow
df_oneShow <- data.frame(
title=exhibitionList[[1]]$title,
time=exhibitionList[[1]]$showInfo[[1]]$time,
location=exhibitionList[[1]]$showInfo[[1]]$location,
locationName=exhibitionList[[1]]$showInfo[[1]]$locationName,
price=exhibitionList[[1]]$showInfo[[1]]$price,
endTime=exhibitionList[[1]]$showInfo[[1]]$endTime,
sourceWebName=exhibitionList[[1]]$sourceWebName,
stringsAsFactors=F
)
df_oneShow
utility_cobb_douglass <- function(x,y,.alpha,.beta){
utilValue <- x^.alpha*y^.beta # 程序產生output值
return(utilValue) # 傳回output值
}
#  dataframe_show_info
dataframe_show_info <- function(exhibitionInput){
df_oneShow <- data.frame(
title=exhibitionInput$title,
time=exhibitionInput$showInfo[[1]]$time,
location=exhibitionInput$showInfo[[1]]$location,
locationName=exhibitionInput$showInfo[[1]]$locationName,
price=exhibitionInput$showInfo[[1]]$price,
endTime=exhibitionInput$showInfo[[1]]$endTime,
sourceWebName=exhibitionInput$sourceWebName,
stringsAsFactors=F
)
return(df_oneShow)
}
dataframe_show_info
#  dataframe_show_info
dataframe_show_info <- function(exhibitionInput){
df_oneShow <- data.frame(
title=exhibitionInput$title,
time=exhibitionInput$showInfo[[1]]$time,
location=exhibitionInput$showInfo[[1]]$location,
locationName=exhibitionInput$showInfo[[1]]$locationName,
price=exhibitionInput$showInfo[[1]]$price,
endTime=exhibitionInput$showInfo[[1]]$endTime,
sourceWebName=exhibitionInput$sourceWebName,
stringsAsFactors=F
)
return(df_oneShow)
}
dataframe_show_info
#  dataframe_show_info
dataframe_show_info <- function(exhibitionInput){
df_oneShow <- data.frame(
title=exhibitionInput$title,
time=exhibitionInput$showInfo[[1]]$time,
location=exhibitionInput$showInfo[[1]]$location,
locationName=exhibitionInput$showInfo[[1]]$locationName,
price=exhibitionInput$showInfo[[1]]$price,
endTime=exhibitionInput$showInfo[[1]]$endTime,
sourceWebName=exhibitionInput$sourceWebName,
stringsAsFactors=F
)
return(df_oneShow)
}
dataframe_show_info(2)
#  dataframe_show_info
dataframe_show_info <- function(exhibitionInput){
df_oneShow <- data.frame(
title=exhibitionInput$title,
time=exhibitionInput$showInfo[[1]]$time,
location=exhibitionInput$showInfo[[1]]$location,
locationName=exhibitionInput$showInfo[[1]]$locationName,
price=exhibitionInput$showInfo[[1]]$price,
endTime=exhibitionInput$showInfo[[1]]$endTime,
sourceWebName=exhibitionInput$sourceWebName,
stringsAsFactors=F
)
return(df_oneShow)
}
dataframe_show_info(exhibitionList[[2]])
#  dataframe_show_info
dataframe_show_info <- function(exhibitionInput){
df_oneShow <- data.frame(
title=exhibitionInput$title,
time=exhibitionInput$showInfo[[1]]$time,
location=exhibitionInput$showInfo[[1]]$location,
locationName=exhibitionInput$showInfo[[1]]$locationName,
price=exhibitionInput$showInfo[[1]]$price,
endTime=exhibitionInput$showInfo[[1]]$endTime,
sourceWebName=exhibitionInput$sourceWebName,
stringsAsFactors=F
)
return(df_oneShow)
}
dataframe_show_info(exhibitionList[[758]])
library(purrr)
map_dfr(exhibitionList,dataframe_show_info) -> df_allShows
?levels
# levels(df_allShows$sourceWebName)
df_allShows$sourceWebName <- as.factor(df_allShows$sourceWebName)
levels(df_allShows$sourceWebName)
# levels(df_allShows$sourceWebName)
df_allShows$sourceWebName <- as.factor(df_allShows$sourceWebName)
levels(df_allShows$sourceWebName)
df_allShows$sourceWebName
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
total1
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
sum(total1) <-  totalCount
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
totalCount <- sum(total1)
class(totalCount)
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
totalCount <- sum(total1)
totalCount <- as.numeric(totalCount)
totalCount
# totalCount
total1 <- (df_allShows$sourceWebName) == "全國藝文活動資訊系統"
totalCount <- sum(total1)
totalCount <- as.numeric(totalCount)
totalCount
class(totalCount)
